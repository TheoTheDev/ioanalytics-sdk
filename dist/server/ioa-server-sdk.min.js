"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.ioaServerSDK=void 0;const http_1=__importDefault(require("http")),https_1=__importDefault(require("https")),url_1=require("url"),httpAgent=new http_1.default.Agent({keepAlive:!0}),httpsAgent=new https_1.default.Agent({keepAlive:!0});class ioaServerSDKCore{constructor(){Object.defineProperty(this,"analyticsURL",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"projectId",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"ioaKey",{enumerable:!0,configurable:!0,writable:!0,value:""})}init(e,t,r="https://ioanalytics.dev"){this.projectId=e,this.analyticsURL=r,this.ioaKey=t}makeRequest(e,t){const r=this.analyticsURL+e,o=new url_1.URL(r),a="https:"===o.protocol,s=a?https_1.default:http_1.default,i=a?httpsAgent:httpAgent,n={hostname:o.hostname,port:o.port||(a?443:80),path:o.pathname+o.search,method:"POST",agent:i,headers:{"Content-Type":"application/json","Content-Length":Buffer.byteLength(t)}},p=s.request(n,(e=>{e.on("data",(()=>{})),e.on("end",(()=>{}))}));p.setTimeout(5e3,(()=>p.destroy())),p.on("error",(()=>{p.destroy()})),p.on("timeout",(()=>p.abort())),p.on("error",(()=>{})),p.write(t),p.end()}newEvent(e,t,r={}){const o=JSON.stringify({projectId:this.projectId,key:this.ioaKey,name:t,type:e,params:r});this.makeRequest("/api/stats/server-event",o)}newError(e,t){const r=JSON.stringify({projectId:this.projectId,key:this.ioaKey,type:e,message:t});this.makeRequest("/api/stats/server-error",r)}}exports.ioaServerSDK=new ioaServerSDKCore;